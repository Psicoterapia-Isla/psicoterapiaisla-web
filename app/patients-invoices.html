<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Facturación</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="assets/css/app.css">
</head>

<body class="app-body">
<header class="app-menu"></header>

<main class="wrapper">
<h1>Facturación</h1>
<div id="list"></div>
</main>

<script type="module">
import { requireAuth } from "./assets/js/auth.js";
import { loadMenu } from "./assets/js/menu.js";
import { auth, db } from "./assets/js/firebase.js";
import { collection, getDocs, query, where }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

await requireAuth();await loadMenu();

const snap=await getDocs(query(
  collection(db,"invoices"),
  where("therapistId","==",auth.currentUser.uid)
));

const list=document.getElementById("list");

snap.forEach(d=>{
  const i=d.data();
  const div=document.createElement("div");
  div.className="card";
  div.innerHTML=`
    <strong>${i.invoiceNumber}</strong><br>
    ${i.patientName || ""}<br>
    ${i.amount} € — ${i.payment?.paid?"Pagada":"Pendiente"}
  `;
  list.appendChild(div);
});
</script>
</body>
</html>
