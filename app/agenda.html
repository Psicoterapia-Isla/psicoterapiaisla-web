<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Agenda | Psicoterapia Isla</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="assets/css/app.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
.wrapper{max-width:900px;margin:0 auto;padding:1.5rem}
.header{display:flex;justify-content:space-between;align-items:center}
.nav button{margin-right:.25rem}
.slot{display:flex;gap:1rem;padding:.5rem;border-radius:8px;margin:.25rem 0;cursor:pointer}
.free{background:#eee}
.busy{background:#dff5e6}
.time{width:60px;font-weight:bold}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.4)}
.modal-card{background:#fff;max-width:420px;margin:10vh auto;padding:1rem;border-radius:12px}
.modal-card input,select{width:100%;margin-bottom:.5rem}
.actions{display:flex;justify-content:flex-end;gap:.5rem}
</style>
</head>

<body class="app-body">
<header class="app-menu"></header>

<main class="wrapper">
  <div class="header">
    <h1>Agenda</h1>
    <div class="nav">
      <button id="prev">←</button>
      <button id="today">Hoy</button>
      <button id="next">→</button>
      <button id="new">+ Cita</button>
    </div>
  </div>

  <p id="dayLabel"></p>
  <div id="agenda"></div>
</main>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-card">
    <h3>Cita</h3>

    <input id="search" placeholder="Buscar paciente (nombre o teléfono)">
    <input id="name" placeholder="Nombre paciente">
    <input id="phone" placeholder="Teléfono">

    <select id="modality">
      <option value="">Modalidad</option>
      <option value="viladecans">Viladecans</option>
      <option value="badalona">Badalona</option>
      <option value="online">Online</option>
    </select>

    <label>
      <input type="checkbox" id="done"> Sesión realizada
    </label>

    <label>
      <input type="checkbox" id="paid"> Pagada
    </label>

    <input id="amount" type="number" placeholder="Importe (€)">

    <div class="actions">
      <button id="pdf">PDF</button>
      <button id="whatsapp">WhatsApp</button>
      <button id="save">Guardar</button>
      <button id="close">Cerrar</button>
    </div>
  </div>
</div>

<script type="module">
import { requireAuth } from "./assets/js/auth.js";
import { loadMenu } from "./assets/js/menu.js";
await requireAuth();
await loadMenu();
</script>

<script type="module" src="assets/js/agenda.js"></script>
</body>
</html>
