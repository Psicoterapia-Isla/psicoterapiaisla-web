<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Sentirme a salvo | Psicoterapia Isla</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../assets/css/app.css">
</head>

<body class="app-body">

  <nav class="app-menu">
    <a href="../index.html">Inicio</a>
    <a href="../diario.html">Diario</a>
    <a href="../ejercicio.html">Ejercicios</a>
    <a href="../login.html">Salir</a>
  </nav>

  <main class="app-container">

    <header>
      <h1>Sentirme a salvo</h1>
      <p>
        Este ejercicio está pensado para ayudarte a identificar señales de
        seguridad en el presente. No es necesario que te relajes ni que te
        sientas bien. Responde solo aquello que te resulte posible ahora.
      </p>
    </header>

    <!-- BLOQUE 1 -->
    <section>
      <h2>1. Seguridad externa</h2>
      <p>
        Observa el entorno que te rodea. No busques calma, solo señales
        objetivas de que ahora mismo no hay peligro.
      </p>

      <label for="seguridad-externa">
        ¿Qué ves, oyes o notas a tu alrededor que indique que este momento es seguro?
      </label>
      <textarea
        id="seguridad-externa"
        placeholder="Por ejemplo: el lugar en el que estás, sonidos neutros, objetos estables…">
      </textarea>
    </section>

    <!-- BLOQUE 2 -->
    <section>
      <h2>2. Seguridad corporal</h2>
      <p>El cuerpo suele registrar la seguridad antes que la mente.</p>

      <label for="seguridad-corporal">
        ¿Hay alguna parte de tu cuerpo que esté un poco menos tensa o más apoyada?
      </label>
      <textarea
        id="seguridad-corporal"
        placeholder="No hace falta que sea todo el cuerpo. Puede ser algo muy pequeño.">
      </textarea>
    </section>

    <!-- BLOQUE 3 -->
    <section>
      <h2>3. Seguridad relacional</h2>
      <p>
        A veces la sensación de seguridad viene de un vínculo, presente o recordado.
      </p>

      <label for="seguridad-relacional">
        ¿Hay alguna persona, animal, recuerdo o presencia que te haga sentir mínimamente protegido/a?
      </label>
      <textarea
        id="seguridad-relacional"
        placeholder="Puedes describirlo o simplemente nombrarlo.">
      </textarea>
    </section>

    <!-- BLOQUE 4 -->
    <section>
      <h2>4. Recurso personal</h2>
      <p>Pensamos ahora en algo concreto y realista que pueda ayudarte hoy.</p>

      <label for="recurso-personal">
        ¿Qué acción pequeña podría aumentar un poco tu sensación de seguridad hoy?
      </label>
      <textarea
        id="recurso-personal"
        placeholder="Algo posible, no perfecto. Incluso algo muy breve.">
      </textarea>
    </section>

    <!-- ARCHIVO OPCIONAL (no se guarda aún) -->
    <section>
      <h2>Material opcional</h2>
      <p>
        Si lo deseas, puedes subir una imagen, foto o documento que represente
        seguridad para ti.
      </p>
      <input type="file" id="archivo-seguridad">
    </section>

    <button id="guardar">Guardar ejercicio</button>

    <p class="legal-note">
      Este ejercicio no sustituye la terapia ni es un canal de urgencias.
      Si te sientes en riesgo, contacta con el 112 o con servicios de emergencia.
    </p>

  </main>

  <script type="module">
    import { saveExercise } from "../assets/js/firebase.js";
    import { requireAuth } from "../assets/js/auth.js";

    requireAuth();

    document.getElementById("guardar").addEventListener("click", async () => {
      try {
        await saveExercise("sentirme_a_salvo", {
          seguridad_externa: document.getElementById("seguridad-externa").value,
          seguridad_corporal: document.getElementById("seguridad-corporal").value,
          seguridad_relacional: document.getElementById("seguridad-relacional").value,
          recurso_personal: document.getElementById("recurso-personal").value
        });

        alert("Ejercicio guardado");
      } catch (error) {
        console.error(error);
        alert("Error al guardar el ejercicio");
      }
    });
  </script>

</body>
</html>
